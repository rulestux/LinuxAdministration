## 110.3 Encrypting Data
__weight 4__


### ~/.ssh/known_hosts
- arquivo que mantém chaves públicas de hosts conhecidos pelo sistema;
- usa-se ```# ssh-keygen -f "/home/USER/.ssh/known_hosts" -R "IP_ADDRESS" ``` para remover um host salvo.

### Public-Key Algorithms
- RSA: tamanho mínimo 1024 bits; padrão: 2048 bits;
- DSA: 'Digital Signature Algorithm' tem exatamente 1024 bits; não é mais usado por ser inseguro;
- ecdsa: 'Elliptic Curve Digital Signature Algorithm' é um aprimoramento do DSA, com três tamanhos possíveis de curvas elípticas em bits: 256, 384 ou 521;
- ed25519: implementação do EdDSA 'Edwards-curve DSA', que usa uma curva 25519, sendo considerado o mais seguro de todos, com um comprimento fixo de 256 bits.

### ssh-keygen
- permite gerar chaves 'secure shell' através de um prompt próprio, que solicita a confirmação do local onde o arquivo será armazenado e uma PASSPHRASE;
- __opções:__
	- '-b' permite definir o número de bits do algoritmo, conforme possível;
	- '-t' especifica um algoritmo fornecido a seguir;
	- '-l -f' lista as impressões digitais das chaves, passando o caminho do arquivo da chave após '-f';
	- '-v' exibe a arte aleatória \(randomart);
	- '-R' exclui as chaves pertencentes a um host fornecido a seguir;
- __ssh-copy-id__ para enviar a chave pública para o arquivo '~/.ssh/authorized_keys' de um host remoto: ```$ ssh-copy-id -i ~/.ssh/PUBLIC_KEY_FILE.pub USERNAME@IP_HOST ```.

### ssh-agent
- utilitário executado em segundo plano que armazena a PASSPHRASE, a fim de agilizar conexões.

### ssh-add
- utilitário que adiciona a PASSPHRASE ao 'ssh-agent' em execução na memória.

### ssh
- o cliente SSH é instalado pelo pacote 'openssh-client';
- o servidor SSH é instalado pelo pacote 'openssh-server';
- sintaxe comum para estabelecer conexão: ```$ ssh USERNAME@HOST_IP ```;
- quando o USERNAME é omitido, a conexão é feita com o nome de usuário local;
- __opções:__
	- '-f' segundo plano, usado com '-N';
	- '-l' permite inserir o nome de usuário para login;
	- '-L' inserir 'LOCAL_PORT:REMOTE_HOST:HOST_PORT' para tunelamento;
	- '-N' dispensa login para um usuário fornecido a seguir;
	- '-p' inserir a porta;
	- '-R' tunelamento para porta remota;
	- '-X' tunelamento para interface X11.

### /etc/ssh/
- diretório de configuração global do OpenSSH;
- '__ssh_config__' é o arquivo de configuração do cliente;
- '__sshd_config__', do servidor;
	- AllowTcpForwarding, GatewayPorts e X11Forwarding são as opções para habilitar ou desabilitar encaminhamentos de porta local, porta remota e X11;
- o diretório contém quatro pares de chaves, públicas e privadas, para cada algoritmo.

### gpg
- utilitário que permite criar chaves GnuPG \(GPG), criptografar arquivos e criar assinaturas;
- normalmente usado com a sintaxe: ```$ gpg --gen-key ```;
	- gera-se o diretório de configuração: __~/.gnupg/__;
	- gera-se o chaveiro público: __~/.gnugpg/pubring.kbx/__;
	- confirma-se um USER-ID e solicita-se uma PASSPHRASE;
- arquivos em __~/.gnupg/__:
	- opengp-revocs.d: diretório que contém um par de chaves e um certificado de revogação;
	- private-keys-v1.d: diretório de chaves privadas;
	- pubring.kbx: chaveiro público;
	- trustdb.gpg: banco de dados de confiabilidade;
- ```$ gpg --list-keys ``` exibe o conteúdo do chaveiro público, com o KEY-ID das chaves;
- ```$ gpg --export USER_ID > FILE.pub.key ``` permite exportar a chave pública;
	-  acrescentando '--armor' ou '-a' a 'gpg --export', cria-se uma saída ASCII blindada cujo nome deve ser fornecido com a extensão '*.asc';
#### Key Sharing
- ```$ gpg --keyserver keyserver-name --send-keys KEY-ID ``` envia uma chave pública;
- ```$ gpg --keyserver keyserver-name --recv-keys KEY-ID ``` baixa uma chave pública recebida;
#### Key Revocation
- ```$ gpg --output REVOCATION_FILE.asc --gen-revoke USERNAME ``` cria um certificado de revogação de chave;
- ```$ gpg --import REVOCATION_FILE.asc ``` importa o certificado para o chaveiro;
#### Ecrypting Files
- ```$ gpg --output /PATH/TO/NEW/ENCRYPTED/FILE --recipient USERNAME --encrypt /PATH/TO/ORIGINAL/FILE ``` para criptografar;
- ```$ gpg --output /PATH/TO/DECRYPTED/FILE --decrypt /PATH/TO/ENCRYPTED/FILE ``` para descriptografar.

### scp
- comando que permite fazer cópias seguras via SSH, passando o nome do arquivo e o caminho no host:
	- ```$ scp FILE.pub.key USERNAME@HOSTNAME:/home/USERNAME/ ```.
